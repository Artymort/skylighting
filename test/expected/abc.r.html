<div class="sourceCode"><pre class="sourceCode"><code class="sourceCode">canMakeNoRecursion &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  x &lt;-<span class="st"> </span><span class="kw">toupper</span>(x)
  charList &lt;-<span class="st"> </span><span class="kw">strsplit</span>(x, <span class="kw">character</span>(<span class="dv">0</span>))
  getCombos &lt;-<span class="st"> </span><span class="cf">function</span>(chars) {
    charBlocks &lt;-<span class="st">  </span><span class="kw">data.matrix</span>(<span class="kw">expand.grid</span>(<span class="kw">lapply</span>(chars, <span class="cf">function</span>(char) <span class="kw">which</span>(blocks <span class="op">==</span><span class="st"> </span>char, <span class="dt">arr.ind=</span><span class="ot">TRUE</span>)[, 1L])))
    charBlocks &lt;-<span class="st"> </span>charBlocks[<span class="op">!</span><span class="kw">apply</span>(charBlocks, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="kw">any</span>(<span class="kw">duplicated</span>(row))), , drop=<span class="ot">FALSE</span>]
    <span class="cf">if</span> (<span class="kw">dim</span>(charBlocks)[1L] <span class="op">&gt;</span><span class="st"> </span>0L) {
      <span class="kw">t</span>(<span class="kw">apply</span>(charBlocks, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="kw">apply</span>(blocks[row, , <span class="dt">drop=</span><span class="ot">FALSE</span>], <span class="dv">1</span>, paste, <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>)))
    } <span class="cf">else</span> {
      <span class="kw">character</span>(<span class="dv">0</span>)
    }
  }
  <span class="kw">setNames</span>(<span class="kw">lapply</span>(charList, getCombos), x)
}
<span class="kw">canMakeNoRecursion</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,
           <span class="st">&quot;BARK&quot;</span>,
           <span class="st">&quot;BOOK&quot;</span>,
           <span class="st">&quot;TREAT&quot;</span>,
           <span class="st">&quot;COMMON&quot;</span>,
           <span class="st">&quot;SQUAD&quot;</span>,
           <span class="st">&quot;CONFUSE&quot;</span>))</code></pre></div>
